#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass IEEEtran
\begin_preamble
% for subfigures/subtables
\usepackage[caption=false,font=footnotesize]{subfig}
\usepackage{algorithm,algorithmic}
\usepackage[bottom]{footmisc}
\end_preamble
\options journal
\use_default_options false
\maintain_unincluded_children false
\begin_local_layout
Format 66
Style Remark
CopyStyle             Theorem
DependsOn         Theorem
LatexName             rem
LabelString           "Remark \thetheorem."
Font
  Shape               Up
  Size                Normal
EndFont
LabelFont
  Shape                Up
  Series              Italic
EndFont
Preamble
  \theoremstyle{plain}
  \newtheorem{rem}[thm]{\protect\remarkname}
EndPreamble
LangPreamble
  \providecommand{\remarkname}{_(Remark)}
EndLangPreamble
BabelPreamble
  \addto\captions$$lang{\renewcommand{\remarkname}{_(Remark)}}
EndBabelPreamble
End
\end_local_layout
\language english
\language_package none
\inputencoding utf8
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures false
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command bibtex
\index_command default
\float_placement tb
\paperfontsize default
\spacing single
\use_hyperref true
\pdf_title "Your Title"
\pdf_author "Your Name"
\pdf_bookmarks true
\pdf_bookmarksnumbered true
\pdf_bookmarksopen true
\pdf_bookmarksopenlevel 1
\pdf_breaklinks false
\pdf_pdfborder true
\pdf_colorlinks false
\pdf_backref false
\pdf_pdfusetitle false
\pdf_quoted_options "pdfpagelayout=OneColumn, pdfnewwindow=true, pdfstartview=XYZ, plainpages=false"
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 2
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
This is a template \SpecialChar LyX
 file for articles to be submitted to journals of the
 Institute of Electrical and Electronics Engineers (IEEE).
 For IEEE conference articles, see the template file 
\emph on
IEEEtran-Conference.lyx
\emph default
.
 For general info see 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://wiki.lyx.org/Examples/IEEE
\end_layout

\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
It is important that you use the correct document class options for your
 document..
 These are explained in the IEEEtran documentation: 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://mirror.ctan.org/macros/latex/contrib/IEEEtran/IEEEtran_HOWTO.pdf
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Title
Analysis of Polynomial Preconditioners
\end_layout

\begin_layout Author
Ferdinand Vanmaele
\begin_inset Newline newline
\end_inset

Universität Heidelberg
\begin_inset Newline newline
\end_inset

Email: Vanmaele@stud.uni-heidelberg.de
\end_layout

\begin_layout Page headings
\begin_inset Argument 1
status open

\begin_layout Plain Layout
Universität Heidelberg, ziti, Advanced Seminar
\end_layout

\end_inset

Ferdinand Vanmaele
\end_layout

\begin_layout Abstract
We explore solving large systems of linear equations using the GMRES method,
 and study the effect of polynomial preconditiong for this method.
 Besides improving convergence for difficult problems, polynomial preconditionin
g allows us to reduce the amount of required scalar products, at the cost
 of more SpMV (sparse matrix-vector multiplication) operations.
 Preconditioning thus improves performance when solving such systems on
 massively parallel systems, where communication costs of scalar products
 can be a bottleneck.
\end_layout

\begin_layout Keywords
Krylov subspaces, GMRES, polynomial preconditioning, communication-avoiding
\end_layout

\begin_layout Peer Review Title
\begin_inset Note Note
status open

\begin_layout Plain Layout
Don't add text here!
\end_layout

\end_inset


\begin_inset Note Note
status open

\begin_layout Plain Layout
required if you use the document class option 
\family sans
peerreview
\family default
, must otherwise not be used
\end_layout

\end_inset


\end_layout

\begin_layout Section
Introduction
\begin_inset CommandInset label
LatexCommand label
name "sec:Introduction"

\end_inset


\end_layout

\begin_layout Standard
Systems of linear equations 
\begin_inset Formula $Ax=b$
\end_inset

, where 
\begin_inset Formula $A$
\end_inset

 is a sparse matrix of high dimension 
\begin_inset Formula $n$
\end_inset

, are widely solved in scientific computing through iterative methods, that
 is, by finding a succession of approximations from an initial value 
\begin_inset CommandInset citation
LatexCommand cite
after "Chapter 6"
key "Magoules-2015"
literal "false"

\end_inset

.
 This is in contrast to direct methods
\begin_inset Note Note
status open

\begin_layout Plain Layout
such as LU decomposition
\end_layout

\end_inset

, which are based on the initial factorization of the coefficient matrix
 and give the result in a number of exactly predictable operations.
 The disadvantage of direct methods lies in a high number of arithmetic
 operations, and in the memory footprint of storing matrices that were initially
 sparse 
\begin_inset CommandInset citation
LatexCommand cite
after "Example 3.3"
key "Saad-2003"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
GMRES (Generalized Minimum Residual) method is an iterative method suitable
 for a wide range of linear systems, including indefinite and nonsymmetric
 systems.
 In every step, it minimizes the norm of the residual vector 
\begin_inset Formula $\|b-A\tilde{x}\|$
\end_inset

 over a Krylov subspace.
 Constructing the Krylov subspace is done through a Gram-Schmidt orthogonalizati
on procedure using inner products.
 On parallel and distributed systems, computing inner products requires
 global reduction operations involving all processes.
 In comparison, sparse matrix-vector multiplications only need to exchange
 data between neighbors 
\begin_inset CommandInset citation
LatexCommand cite
after "14.5"
key "Magoules-2015"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
To address this issue, we consider preconditioned systems 
\begin_inset Formula $M^{-1}Ax=M^{-1}b$
\end_inset

, where 
\begin_inset Formula $M^{-1}$
\end_inset

 is a (typically low degree) matrix polynomial.
 This preconditioned system has the same solution as the original system
 
\begin_inset Formula $Ax=b$
\end_inset

, but may achieve faster convergence.
 Achieving a certain tolerance for the residual thus occurs in less GMRES
 steps (inner products), at the expense of more matrix-vector multiplications
 in every step.
 We discuss a polynomial which does not require knowledge of the spectrum
 of the matrix 
\begin_inset Formula $A$
\end_inset

.
 Finding the coefficients of 
\begin_inset Formula $M^{-1}$
\end_inset

 requires a (possibly dense) matrix-matrix multiplication.
 This cost can be controlled by the degree of the polynomial, depending
 on the difficulty of the problem, making it more granular than classical
 preconditioners such as Incomplete LU (ILU) factorizations.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
citation? (from vorbesprechung)
\end_layout

\end_inset


\end_layout

\begin_layout Section
Related Work
\begin_inset CommandInset label
LatexCommand label
name "sec:Related-Work"

\end_inset


\end_layout

\begin_layout Standard
Saad 
\begin_inset CommandInset citation
LatexCommand cite
key "Saad-1986"
literal "false"

\end_inset

 introduced the GMRES method for systems in which the coefficent matrix
 
\begin_inset Formula $A$
\end_inset

 is nonsymmetric or indefinite.
 Indefinite systems commonly arise, for example, in mixed finite element
 methods for solving problems in fluid and solid mechanics 
\begin_inset CommandInset citation
LatexCommand cite
key "Benzi-2005,Rozložník-2018"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
Since then, the algorithms have been included in general textbooks on numerical
 linear algebra and scientific computing 
\begin_inset CommandInset citation
LatexCommand cite
key "Saad-2003,Trefethen-1997,Magoules-2015"
literal "false"

\end_inset

.
 Implementations are available in MATLAB and scientific computing libraries
 such as GSL and TRILINOS.
 Liu 
\begin_inset CommandInset citation
LatexCommand cite
key "Liu-2015"
literal "false"

\end_inset

 discusses polynomial preconditioning with GMRES and introduces a way to
 find the coefficients without knowledge of the matrix spectrum.
 Loe et.
 al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Loe-2019"
literal "false"

\end_inset

 conducted further experiments on (shared-memory) parallel hardware with
 TRILINOS.
 
\end_layout

\begin_layout Standard
Besides polynomial preconditioning, Block Krylov methods also help reduce
 the effect of inner products on communication.
 Saad 
\begin_inset CommandInset citation
LatexCommand cite
after "6.12"
key "Saad-2003"
literal "false"

\end_inset

 put forward an overview and gives further references.
 
\end_layout

\begin_layout Standard
After revisiting theoretical results on Krylov subspaces and GMRES in Sections
 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Krylov-subspaces"
plural "false"
caps "false"
noprefix "false"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:The-GMRES-method"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Convergence-of-GMRES"
plural "false"
caps "false"
noprefix "false"

\end_inset

, we introduce polynomial preconditioning and its advantages in Section
 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Preconditioning"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 In Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Numerical-experiments"
plural "false"
caps "false"
noprefix "false"

\end_inset

 we test the impact of polynomial preconditioning on convergence for several
 test problems.
 
\end_layout

\begin_layout Section
Krylov subspaces
\begin_inset CommandInset label
LatexCommand label
name "sec:Krylov-subspaces"

\end_inset

 
\end_layout

\begin_layout Standard
We will look at iterative methods for solving the linear system 
\begin_inset Formula $Ax=b$
\end_inset

 of dimension 
\begin_inset Formula $n$
\end_inset

, where 
\begin_inset Formula $A$
\end_inset

 is an invertible square matrix, with approximate solutions in Krylov subspaces.
 These methods can be applied to either real or complex matrices.
 We introduce Krylov subspaces and construct an orthonormal basis.
 Solving a least squares problem to find the minimum residual for vectors
 in this subspace leads to the GMRES method.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
A general 
\series bold
projection method
\series default
 for solving the linear system 
\begin_inset Formula $Ax=b$
\end_inset

 extracts an approximate solution 
\begin_inset Formula $x_{m}$
\end_inset

 from an affine subspace 
\begin_inset Formula $x_{0}+\mathcal{K}_{m}$
\end_inset

of dimension 
\begin_inset Formula $m$
\end_inset

 by imposing the Petrov-Galerkin condition 
\begin_inset Formula $b-Ax_{m}\perp\mathcal{L}_{m}$
\end_inset

, where 
\begin_inset Formula $\mathcal{L}_{m}$
\end_inset

 is another subspace of dimension 
\begin_inset Formula $m$
\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Definition
\begin_inset Argument 1
status open

\begin_layout Plain Layout
\begin_inset CommandInset citation
LatexCommand cite
after "6.2"
key "Saad-2003"
literal "false"

\end_inset


\end_layout

\end_inset

The 
\series bold
Krylov subspace
\series default
 of order 
\begin_inset Formula $m$
\end_inset

, denoted by 
\begin_inset Formula $\mathcal{K}_{p}$
\end_inset

, is the vector space spanned by 
\begin_inset Formula $v\in\mathbb{R}^{n}$
\end_inset

 and the first 
\begin_inset Formula $m-1$
\end_inset

 powers of 
\begin_inset Formula $A$
\end_inset

:
\begin_inset Formula 
\[
\mathcal{K}_{m}(A,v)=\text{span}\{v,Av,A^{2}v,\ldots,A^{m-1}v\}.
\]

\end_inset

The Krylov subspaces form an increasing family of subspaces, with dimension
 bounded by 
\begin_inset Formula $n$
\end_inset

.
 It is the subspace of all vectors in 
\begin_inset Formula $\mathbb{R}^{n}$
\end_inset

 which can be written as 
\begin_inset Formula $x=p(A)v$
\end_inset

, where 
\begin_inset Formula $p$
\end_inset

 is a polynomial of degree not exceeding 
\begin_inset Formula $m-1$
\end_inset

.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
In fact, it is of dimension 
\begin_inset Formula $m$
\end_inset

 if and only if the degree of the minimal polynomial of 
\begin_inset Formula $g_{0}$
\end_inset

 with respect to 
\begin_inset Formula $A$
\end_inset

 is not less than 
\begin_inset Formula $m$
\end_inset

.
\begin_inset CommandInset citation
LatexCommand cite
after "Proposition 6.2"
key "Saad-2003"
literal "false"

\end_inset


\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
In practice, constructing the Krylov subspaces amounts to determining their
 basis.
 The power basis 
\begin_inset Formula $(v,Av,A^{2}v,\ldots,A^{m-1}v)$
\end_inset

 converges to (a multiple of) an eigenvector that corresponds to the largest
 eigenvalue of 
\begin_inset Formula $A$
\end_inset

, in absolute value 
\begin_inset CommandInset citation
LatexCommand cite
after "10.2"
key "Magoules-2015"
literal "false"

\end_inset

.
 Therefore we construct an orthonormal basis 
\begin_inset Formula $\{v_{1},v_{2},\ldots,v_{m}\}$
\end_inset

 as follows.
 
\end_layout

\begin_layout Standard

\series bold
Arnoldi's method
\series default
 applies the (modified) Gram-Schmidt orthonormalization procedure to the
 vectors obtained by successive products of the matrix 
\begin_inset Formula $A$
\end_inset

.
 Algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:Arnoldi-Modified-Gram-Schmidt"
plural "false"
caps "false"
noprefix "false"

\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
after "6.3.2"
key "Saad-2003"
literal "false"

\end_inset

 gives a practical implementation.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
note: 
\begin_inset CommandInset citation
LatexCommand cite
key "Loe-2019"
literal "false"

\end_inset

 uses classical gram-schmidt
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
Choose a vector 
\begin_inset Formula $v_{1}$
\end_inset

 of norm 1
\end_layout

\begin_layout Plain Layout

\series bold
For
\series default
 
\begin_inset Formula $j=1,2,\ldots,m$
\end_inset

 
\series bold
Do
\series default
:
\end_layout

\begin_layout Plain Layout
\begin_inset space \hspace{}
\length 2em
\end_inset

Compute 
\begin_inset Formula $w_{j}:=Av_{j}$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset space \hspace{}
\length 2em
\end_inset


\series bold
For
\series default
 
\begin_inset Formula $i=1,\cdots,j$
\end_inset

 
\series bold
Do
\series default
:
\end_layout

\begin_layout Plain Layout
\begin_inset space \hspace{}
\length 2em
\end_inset


\begin_inset space \hspace{}
\length 2em
\end_inset


\begin_inset Formula $h_{ij}=(w_{j},v_{i})$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset space \hspace{}
\length 2em
\end_inset


\begin_inset space \hspace{}
\length 2em
\end_inset


\begin_inset Formula $w_{j}:=w_{j}-h_{ij}v_{i}$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset space \hspace{}
\length 2em
\end_inset


\series bold
EndDo
\end_layout

\begin_layout Plain Layout
\begin_inset space \hspace{}
\length 2em
\end_inset


\begin_inset Formula $h_{j+1,j}=\|w_{j}\|_{2}$
\end_inset

.
 If 
\begin_inset Formula $h_{j+1,j}=0$
\end_inset

 
\series bold
Stop
\end_layout

\begin_layout Plain Layout
\begin_inset space \hspace{}
\length 2em
\end_inset


\begin_inset Formula $v_{j+1}=w_{j}/h_{j+1,j}$
\end_inset


\end_layout

\begin_layout Plain Layout

\series bold
EndDo
\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Arnoldi-Modified Gram-Schmidt
\begin_inset CommandInset label
LatexCommand label
name "alg:Arnoldi-Modified-Gram-Schmidt"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The modified Gram-Schmidt procedure has better numerical properties than
 the classical procedure 
\begin_inset CommandInset citation
LatexCommand cite
after "6.3.2"
key "Saad-2003"
literal "false"

\end_inset

, but requires additional synchronization points when implemented on a parallel
 computer.
 Additional methods such as DCGS2 were introduced to address these issues
 
\begin_inset CommandInset citation
LatexCommand cite
key "Hernandez-2005"
literal "false"

\end_inset

.
 Householder transformations, which are relatively costly but stable, were
 also proposed 
\begin_inset CommandInset citation
LatexCommand cite
after "2.3.4"
key "Barret-1994"
literal "false"

\end_inset

.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
with worse parallelization properties
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The following important relations hold for the Arnoldi basis: 
\begin_inset Formula 
\[
AV_{m}=V_{m+1}\overline{H}_{m},\qquad V_{m}^{T}AV_{m}=H_{m},
\]

\end_inset

where 
\begin_inset Formula $V_{m}$
\end_inset

 denotes the 
\begin_inset Formula $n\times m$
\end_inset

 matrix with orthonormal column vectors 
\begin_inset Formula $v_{1},\ldots,v_{m}$
\end_inset

, 
\begin_inset Formula $\overline{H}_{m}$
\end_inset

 the 
\begin_inset Formula $(m+1)\times m$
\end_inset

 Hessenberg matrix
\begin_inset Note Note
status open

\begin_layout Plain Layout
all zero entries below the subdiagonal
\end_layout

\end_inset

 with nonzero entries 
\begin_inset Formula $h_{ij}$
\end_inset

, and 
\begin_inset Formula $H_{m}$
\end_inset

 the matrix obtained from 
\begin_inset Formula $\overline{H}_{m}$
\end_inset

 by deleting its last row: 
\begin_inset CommandInset citation
LatexCommand cite
after "Proposition 6.5"
key "Saad-2003"
literal "false"

\end_inset


\begin_inset Formula 
\[
H_{m}=\begin{pmatrix}h_{1,1} & h_{1,2} & \cdots & \cdots & h_{1,m}\\
h_{2,1} & h_{2,2} &  &  & \vdots\\
 & h_{3,2} & \ddots &  & \vdots\\
 &  & \ddots & \ddots & \vdots\\
 &  &  & h_{m,m-1} & h_{m,m}
\end{pmatrix}.
\]

\end_inset


\end_layout

\begin_layout Section
The GMRES method
\begin_inset CommandInset label
LatexCommand label
name "sec:The-GMRES-method"

\end_inset


\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $r_{0}=b-Ax_{0}$
\end_inset

 denote the residual for an initial approximation 
\begin_inset Formula $x_{0}$
\end_inset

.
 Let 
\begin_inset Formula $\mathcal{K}_{m}:=\mathcal{K}_{m}(A,r_{0})$
\end_inset

.
 We seek to minimize the residual on the affine subspace 
\begin_inset Formula $x_{0}+\mathcal{K}_{m}$
\end_inset

 of dimension 
\begin_inset Formula $m$
\end_inset

.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
Our problem is to find a vector 
\begin_inset Formula $c\in\mathbb{C}^{n}$
\end_inset

such that 
\begin_inset Formula $\|AK_{n}c-b\|$
\end_inset

 = minimum
\end_layout

\end_inset


\end_layout

\begin_layout Definition
Choose 
\begin_inset Formula $v_{1}=r_{0}/\|r_{0}\|$
\end_inset

 for the Arnoldi basis, and let 
\begin_inset Formula $\beta:=\|r_{0}\|$
\end_inset

.
 Any vector in 
\begin_inset Formula $x_{0}+\mathcal{K}_{m}$
\end_inset

 can be written as 
\begin_inset Formula $x=x_{0}+V_{m}y$
\end_inset

, where 
\begin_inset Formula $y\in\mathbb{R}^{m}$
\end_inset

.
 By the above relation, the objective is given as: 
\begin_inset CommandInset citation
LatexCommand cite
after "6.5.1"
key "Saad-2003"
literal "false"

\end_inset


\begin_inset Formula 
\begin{align*}
J(y) & =\|b-A(x_{0}+V_{m}y)\|_{2}=\|r_{0}-AV_{m}y\|_{2}\\
 & =\|\beta v_{1}-V_{m+1}\overline{H}_{m}y\|_{2}.
\end{align*}

\end_inset

By orthonormality of 
\begin_inset Formula $V_{m+1}$
\end_inset

 column vectors, 
\begin_inset Formula $J(y)=\|\beta e_{1}-\overline{H}_{m}y\|$
\end_inset

.
 The 
\series bold
GMRES approximation
\series default
 is then the unique vector 
\begin_inset Note Note
status open

\begin_layout Plain Layout
\begin_inset Formula $V_{m}$
\end_inset

 is 
\begin_inset Formula $m$
\end_inset

-dimensional basis -> unique solution to least squares problem ; 
\begin_inset Formula $m$
\end_inset

 orthogonality restraints
\end_layout

\end_inset

 of 
\begin_inset Formula $x_{0}+\mathcal{K}_{m}$
\end_inset

 which minimizes 
\begin_inset Formula $J$
\end_inset

.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
in each step
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
This results in Algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:GMRES"
plural "false"
caps "false"
noprefix "false"

\end_inset

 (
\begin_inset CommandInset citation
LatexCommand cite
after "Algorithm 6.9"
key "Saad-2003"
literal "false"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
Compute 
\begin_inset Formula $r_{0}=b-Ax_{0}$
\end_inset

, 
\begin_inset Formula $\beta:=\|r_{0}\|_{2}$
\end_inset

, and 
\begin_inset Formula $v_{1}:=r_{0}/\beta$
\end_inset


\end_layout

\begin_layout Plain Layout

\series bold
For
\series default
 
\begin_inset Formula $j=1,2,\ldots,m$
\end_inset

 
\series bold
Do
\series default
:
\end_layout

\begin_layout Plain Layout
\begin_inset space \hspace{}
\length 2em
\end_inset


\begin_inset Formula $\langle$
\end_inset

 step 
\begin_inset Formula $n$
\end_inset

 of Arnoldi iteration, Algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:Arnoldi-Modified-Gram-Schmidt"
plural "false"
caps "false"
noprefix "false"

\end_inset

 
\begin_inset Formula $\rangle$
\end_inset


\end_layout

\begin_layout Plain Layout

\series bold
EndDo
\end_layout

\begin_layout Plain Layout
Define the 
\begin_inset Formula $(m+1)\times m$
\end_inset

 Hessenberg matrix 
\begin_inset Formula $\overline{H}_{m}=\{h_{ij}\}_{1\leq i\leq m+1,1\leq j\leq m}$
\end_inset


\end_layout

\begin_layout Plain Layout
Compute 
\begin_inset Formula $y_{m}$
\end_inset

 the minimizer of 
\begin_inset Formula $\|\beta e_{1}-\overline{H}_{m}y\|_{2}$
\end_inset

 and 
\begin_inset Formula $x_{m}=x_{0}+V_{m}y_{m}$
\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
GMRES
\begin_inset CommandInset label
LatexCommand label
name "alg:GMRES"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Computing 
\begin_inset Formula $y_{m}$
\end_inset

 is an 
\begin_inset Formula $(m+1)\times m$
\end_inset

 matrix least squares problem with Hessenberg structure that can be solved
 via QR factorization in the usual manner, at the cost of 
\begin_inset Formula $\mathcal{O}(m^{2})$
\end_inset

 operations.
 To save further work, rather than construct QR factorizations of the successive
 matrices 
\begin_inset Formula $\overline{H}_{1},\overline{H}_{2},\ldots$
\end_inset

 independently, we can use an updating process to get the QR factorization
 of 
\begin_inset Formula $\overline{H}_{m}$
\end_inset

 from that of 
\begin_inset Formula $\overline{H}_{m-1}$
\end_inset

.
 Doing so requires a single 
\series bold
Givens rotation
\series default
 and 
\begin_inset Formula $\mathcal{O}(m)$
\end_inset

 work 
\begin_inset CommandInset citation
LatexCommand cite
after "Mechanics of GMRES"
key "Trefethen-1997"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
This approach also enables obtaining the residual norm of the approximate
 solution without computing 
\begin_inset Formula $x_{k}$
\end_inset

, thus allowing to decide when to stop the algorithm inexpensively 
\begin_inset CommandInset citation
LatexCommand cite
after "3.2"
key "Saad-1986"
literal "false"

\end_inset

.
 Saad 
\begin_inset CommandInset citation
LatexCommand cite
key "Saad-1986,Saad-2003"
literal "false"

\end_inset

 gives the detailed implementation.
\end_layout

\begin_layout Standard
Consider now the algorithm from a practical viewpoint.
 As 
\begin_inset Formula $m$
\end_inset

 increases, the computational cost increases at least as 
\begin_inset Formula $\mathcal{O}(m^{2}n)$
\end_inset

 because of the Gram-Schmidt orthogonalization.
 The memory cost increases as 
\begin_inset Formula $\mathcal{O}(mn)$
\end_inset

.
 For large 
\begin_inset Formula $n$
\end_inset

 this limits the largest value of 
\begin_inset Formula $m$
\end_inset

 that can be used.
 One remedy is to restart the algorithm periodically 
\begin_inset CommandInset citation
LatexCommand cite
after "6.4.1, 6.5.5"
key "Saad-2003"
literal "false"

\end_inset

.
 This is the 
\series bold
restarted GMRES
\series default
 or GMRES(m) algorithm.
 Note that GMRES(m) does not necessarily converge, unless the matrix 
\begin_inset Formula $A$
\end_inset

 is positive definite 
\begin_inset CommandInset citation
LatexCommand cite
after "3.4"
key "Saad-1986"
literal "false"

\end_inset

.
\end_layout

\begin_layout Section
Convergence of GMRES
\begin_inset CommandInset label
LatexCommand label
name "sec:Convergence-of-GMRES"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
A difficulty with GMRES(m) is that the residual norms, although nonincreasing,
 do not necessarily converge to zero, unless the matrix 
\begin_inset Formula $A$
\end_inset

 is positive definite.
 For an 
\begin_inset Formula $n\times n$
\end_inset

 problem, the full GMRES algorithm is guaranteed to converge in at most
 
\begin_inset Formula $n$
\end_inset

 steps (where 
\begin_inset Formula $K_{n}=\mathbb{R}^{n})$
\end_inset

, but this would be impractical if there were many steps required for convergenc
e.
 A typical remedy is to use 
\series bold
preconditioning techniques
\series default
, whose goal is to reduce the number of steps required to converge 
\begin_inset CommandInset citation
LatexCommand cite
after "6.5.5"
key "Saad-2003"
literal "false"

\end_inset

.g
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Because 
\begin_inset Formula $\|r_{m}\|$
\end_inset

 is as small as possible for the subspace 
\begin_inset Formula $\mathcal{K}_{m}$
\end_inset

, by enlarging 
\begin_inset Formula $\mathcal{K}_{m}$
\end_inset

 to the space 
\begin_inset Formula $\mathcal{K}_{m+1}$
\end_inset

 we can only decrease the residual norm, or at worst leave it unchanged.
 Thus we observe that GMRES converges monotonically: 
\begin_inset Formula $\|r_{m+1}\|\leq\|r_{m}\|$
\end_inset

.
 After 
\begin_inset Formula $n$
\end_inset

 steps (for an 
\begin_inset Formula $n\times n$
\end_inset

 problem), we have 
\begin_inset Formula $\mathcal{K}_{n}=\mathbb{C}^{n}$
\end_inset

 and the full GMRES algorithm is guaranteed to converge.
 However, for GMRES to be useful, it must converge to satisfactory precision
 in 
\begin_inset Formula $n\ll m$
\end_inset

 steps 
\begin_inset CommandInset citation
LatexCommand cite
after "p.270"
key "Trefethen-1997"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
To obtain more useful information about convergence, we must turn to the
 following problem.
 The iterate 
\begin_inset Formula $x_{m}\in x_{0}+\mathcal{K}_{m}$
\end_inset

 can be written as 
\begin_inset Formula $x_{m}=x_{0}+q(A)r_{0}$
\end_inset

, where 
\begin_inset Formula $q$
\end_inset

 is a polynomial of degree 
\begin_inset Formula $m-1$
\end_inset

.
 
\end_layout

\begin_layout Standard
Furthermore, as 
\begin_inset Formula $x_{m}$
\end_inset

 minimizes 
\begin_inset Formula $\|r_{m}\|=\|b-Ax_{m}\|$
\end_inset

 in the affine subspace 
\begin_inset Formula $x_{0}+\mathcal{K}_{m}$
\end_inset

, we have 
\begin_inset Formula $x_{m}=x_{0}+q_{m}(A)r_{0}$
\end_inset

, where 
\begin_inset Formula $q_{m}$
\end_inset

 is the polynomial that solves: 
\begin_inset CommandInset citation
LatexCommand cite
after "Lemma 6.31"
key "Saad-2003"
literal "false"

\end_inset

 
\begin_inset Note Note
status open

\begin_layout Plain Layout
by orthogonal projection on the affine subspace
\end_layout

\end_inset


\begin_inset Note Note
status open

\begin_layout Plain Layout
\begin_inset Formula $b-Ax_{0}-q_{m}(A)r_{0}$
\end_inset


\end_layout

\end_inset


\begin_inset Formula 
\begin{align*}
\|r_{m}\| & =\|b-A(x_{0}+q_{m}(A)r_{0})\|=\min_{q\in P_{m-1}}\|(I-Aq(A))r_{0}\|\\
 & =\min_{p\in P_{m},p(0)=1}\|p(A)r_{0}\|.
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
The polynomial 
\begin_inset Formula $p$
\end_inset

 is determined by GMRES.
 We can show:
\end_layout

\begin_layout Theorem
\begin_inset Argument 1
status open

\begin_layout Plain Layout
\begin_inset CommandInset citation
LatexCommand cite
after "Proposition 6.32"
key "Saad-2003"
literal "false"

\end_inset

 
\end_layout

\end_inset

Suppose 
\begin_inset Formula $A$
\end_inset

 is diagonalizable, satisfying 
\begin_inset Formula $A=X\Lambda X^{-1}$
\end_inset

 with 
\begin_inset Formula $\Lambda=\text{diag}\{\lambda_{1},\lambda_{2},\ldots,\lambda_{n}\}$
\end_inset

 is the diagonal matrix of eigenvalues.
 We have the following upper bound on the residual:
\begin_inset Formula 
\[
\|r_{m}\|\leq\kappa_{2}(X)\,\min_{p\in\mathbb{P}_{m},p(0)=1}\max|p(\lambda_{i})|.
\]

\end_inset


\end_layout

\begin_layout Standard
This theorem
\begin_inset Note Note
status open

\begin_layout Plain Layout
result? proposition?
\end_layout

\end_inset

 can be summarized in words as follows.
 If 
\begin_inset Formula $A$
\end_inset

 is not too far from normal in the sense that 
\begin_inset Formula $\mathcal{K}(X)$
\end_inset

 is not too large, and if properly normalized degree 
\begin_inset Formula $m$
\end_inset

 polynomials can be found whose size on the spectrum 
\begin_inset Formula $\Lambda(A)$
\end_inset

 decreases quickly with 
\begin_inset Formula $m$
\end_inset

, then GMRES converges quickly 
\begin_inset CommandInset citation
LatexCommand cite
after "p.271"
key "Trefethen-1997"
literal "false"

\end_inset

.
\end_layout

\begin_layout Example
Let 
\begin_inset Formula $n=4000$
\end_inset

, with entries sampled from 
\begin_inset Formula $\mathcal{N}(2,0.5/\sqrt{n})$
\end_inset

.
 The eigenvalues are roughly uniformly distributed in the disk of radius
 
\begin_inset Formula $\frac{1}{2}$
\end_inset

 centered at 
\begin_inset Formula $z=2$
\end_inset

.
 
\begin_inset Formula $\|p(A)\|$
\end_inset

 is then approximately minimized by 
\begin_inset Formula $p(z)=(1-z/2)^{m}$
\end_inset

, with a convergence rate of 
\begin_inset Formula $4^{-m}$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "Trefethen-1997"
literal "false"

\end_inset

.
\end_layout

\begin_layout Corollary
\begin_inset Argument 1
status open

\begin_layout Plain Layout
\begin_inset CommandInset citation
LatexCommand cite
key "Saad-1986"
literal "false"

\end_inset


\end_layout

\end_inset

Suppose 
\begin_inset Formula $A$
\end_inset

 is positive real with symmetric part 
\begin_inset Formula $M=\frac{1}{2}(A+A^{T})$
\end_inset

.
 We have the following upper bound on the residual:
\begin_inset Formula 
\[
\|r_{m}\|\leq\left(1-\frac{\lambda_{\min}(1/2(A^{T}+A))^{2}}{\lambda_{\max}(A^{T}A)}\right)^{\nicefrac{m}{2}}\|r_{0}\|.
\]

\end_inset


\end_layout

\begin_layout Standard
In particular, if 
\begin_inset Formula $A$
\end_inset

 is symmetric positive definite, we have:
\begin_inset Formula 
\[
\|r_{m}\|\leq\left(\frac{\kappa(A)^{2}-1}{\kappa(A)^{2}}\right)^{\nicefrac{m}{2}}\|r_{0}\|,
\]

\end_inset

where 
\begin_inset Formula $\kappa=\|A\|\|A^{-1}\|$
\end_inset

 denotes the condition number of 
\begin_inset Formula $A$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
More convergence results in Saad 
\begin_inset CommandInset citation
LatexCommand cite
key "Saad-1986"
literal "false"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Preconditioning
\begin_inset CommandInset label
LatexCommand label
name "sec:Preconditioning"

\end_inset


\end_layout

\begin_layout Standard
For any nonsingular 
\begin_inset Formula $n\times n$
\end_inset

 matrix 
\begin_inset Formula $M$
\end_inset

, the system 
\begin_inset Formula 
\[
M^{-1}Ax=M^{-1}b
\]

\end_inset

 has the same solution as the nonsingular system 
\begin_inset Formula $Ax=b$
\end_inset

.
 Solving this system depends on the properties of 
\begin_inset Formula $M^{-1}A$
\end_inset

, and may require fewer steps to converge than the original system 
\begin_inset CommandInset citation
LatexCommand cite
after "10.1"
key "Saad-2003"
literal "false"

\end_inset

.
 We call 
\begin_inset Formula $M$
\end_inset

 the 
\series bold
preconditioner
\series default
.
 The preconditioner can be either applied to the left or right.
 Latter leads to the system
\begin_inset Formula 
\begin{align*}
AM^{-1}u & =b,\\
x & =M^{-1}u.
\end{align*}

\end_inset

This amounts to making the change of variables 
\begin_inset Formula $u=Mx$
\end_inset

, and solving the system with respect to the unknown 
\begin_inset Formula $u$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
after "9.1"
key "Saad-2003"
literal "false"

\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset Formula $M$
\end_inset

 should meet the following requirements:
\end_layout

\begin_layout Itemize
\begin_inset Formula $M$
\end_inset

 lies between 
\begin_inset Formula $M=A$
\end_inset

 (for the equally hard to solve system 
\begin_inset Formula $x=A^{-1}b$
\end_inset

) and 
\begin_inset Formula $M=I$
\end_inset

 (for the original system 
\begin_inset Formula $Ax=b)$
\end_inset

.
\end_layout

\begin_layout Itemize
\begin_inset Formula $M^{-1}$
\end_inset

 is inexpensive to apply to an arbitrary vector.
\end_layout

\begin_layout Itemize
\begin_inset Formula $M$
\end_inset

 is 
\begin_inset Quotes eld
\end_inset

close enough
\begin_inset Quotes erd
\end_inset

 to 
\begin_inset Formula $A$
\end_inset

, in the sense that the preconditioned system 
\begin_inset Formula $M^{-1}Ax=M^{-1}b$
\end_inset

 converges more quickly than the system 
\begin_inset Formula $Ax=b$
\end_inset

.
 Specifically, we want 
\begin_inset Formula $\|I-M^{-1}A\|$
\end_inset

 to be small and the eigenvalues of 
\begin_inset Formula $M^{-1}A$
\end_inset

 close to 1, or clustered around some other value 
\begin_inset CommandInset citation
LatexCommand cite
after "Lecture 40"
key "Trefethen-1997"
literal "false"

\end_inset

.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
important point for graphs later
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Note the following differences when preconditioning GMRES: 
\begin_inset CommandInset citation
LatexCommand cite
after "9.3"
key "Saad-2003"
literal "false"

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Itemize
Left preconditioning:
\end_layout

\begin_deeper
\begin_layout Itemize
builds an orthogonal basis of the Krylov subspace 
\begin_inset Note Note
status open

\begin_layout Plain Layout
shorten or put on same line?
\end_layout

\end_inset


\begin_inset Formula 
\[
\text{span}\{r_{0},M^{-1}Ar_{0},\dots,(M^{-1}A)^{m-1}r_{0}\};
\]

\end_inset


\end_layout

\begin_layout Itemize
obtains the residuals relative to the preconditioned system, i.e.
 
\begin_inset Formula $M^{-1}(b-Ax_{m})$
\end_inset

;
\end_layout

\begin_layout Itemize
uses one preconditioning operation at the beginning of the outer loop, 
\begin_inset Formula $r_{0}=M^{-1}(b-Ax_{0}$
\end_inset

).
\end_layout

\end_deeper
\begin_layout Itemize
Right preconditioning:
\end_layout

\begin_deeper
\begin_layout Itemize
builds an orthogonal basis of the Krylov subspace 
\begin_inset Note Note
status open

\begin_layout Plain Layout
shorten or put on same line?
\end_layout

\end_inset


\begin_inset Formula 
\[
\text{span}\{r_{0},AM^{-1}r_{0},\dots,(AM^{-1})^{m-1}r_{0}\};
\]

\end_inset


\end_layout

\begin_layout Itemize
obtains the residuals relative to the initial system, i.e.
 
\begin_inset Formula $b-Ax_{m}$
\end_inset

;
\end_layout

\begin_layout Itemize
uses one preconditioning operation at the end of the outer loop, 
\begin_inset Formula $x_{m}=x_{0}+M^{-1}V_{m}y_{m}$
\end_inset

.
\end_layout

\end_deeper
\begin_layout Subsection
Polynomial preconditioning
\end_layout

\begin_layout Standard
Consider the characteristic polynomial 
\begin_inset Formula $\chi_{A}$
\end_inset

 of 
\begin_inset Formula $A$
\end_inset

.
 With the Caley-Hamilton theorem, we have 
\begin_inset Formula 
\[
\chi_{A}(A)=a_{n}A^{n}+a_{n-1}A^{n-1}+\cdots+a_{1}A+a_{0}I=0,
\]

\end_inset

and so, for 
\begin_inset Formula $a_{0}\neq0$
\end_inset

, 
\begin_inset Formula 
\[
A^{-1}=\frac{1}{a_{0}}(-a_{n}A^{n-1}-a_{n-1}A^{n-2}-\cdots-a_{1}I).
\]

\end_inset

It thus makes sense to approximate 
\begin_inset Formula $A^{-1}$
\end_inset

 with a polynomial 
\begin_inset Formula $s(A)$
\end_inset

.
 We set 
\begin_inset Formula $M^{-1}=s(A)$
\end_inset

, and assume 
\begin_inset Formula $s$
\end_inset

 to have degree 
\begin_inset Formula $d\ll n$
\end_inset

.
 Note that 
\begin_inset Formula $s(A)A=As(A)$
\end_inset

, so left and right preconditioning build the same Krylov subspace.
 We call 
\begin_inset Formula $M^{-1}$
\end_inset

 a 
\series bold
polynomial preconditioner
\series default
.
\end_layout

\begin_layout Standard
The matrix 
\begin_inset Formula $s(A)$
\end_inset

 does not need to be formed explicitly: 
\begin_inset Formula $s(A)v$
\end_inset

 can be computed for any vector 
\begin_inset Formula $v$
\end_inset

 from a sequence of matrix-by-vector products 
\begin_inset CommandInset citation
LatexCommand cite
after "12.3"
key "Saad-2003"
literal "false"

\end_inset

.
 In particular, 
\series bold
Horner's method
\series default
 computes 
\begin_inset Formula $s(A)v$
\end_inset

 with 
\begin_inset Formula $d$
\end_inset

 matrix-vector products: 
\begin_inset Formula 
\begin{align*}
s(A)v & =s_{d+1}A^{d}v+s_{d}A^{d-1}v+\cdots+s_{1}v\\
 & =A(A\cdots(s_{d+1}Av+s_{d}v)+\cdots+s_{2}v)+s_{1}v.
\end{align*}

\end_inset


\end_layout

\begin_layout Remark
A polynomial preconditioner may be combined with other preconditioners 
\begin_inset Formula $M'$
\end_inset

, such as ILU(
\begin_inset Formula $k$
\end_inset

), by solving the system:
\begin_inset Formula 
\[
s(M'^{-1}A)M'^{-1}A=s(M'^{-1}A)M'^{-1}b.
\]

\end_inset


\end_layout

\begin_layout Standard
We now compute a polynomial preconditioner related to the GMRES polynomial,
 corresponding to a minimal residual 
\begin_inset Formula $\|p(A)r_{0}\|=\|(I-Aq(A))r_{0}\|$
\end_inset

.
 For a preconditioner, we compute 
\begin_inset Formula $q(A)$
\end_inset

 instead.
 Denote this polynomial by 
\begin_inset Formula $M^{-1}=s(A)$
\end_inset

 as above, and let 
\begin_inset Formula $v_{0}\neq0$
\end_inset

.
 We solve:
\begin_inset Formula 
\[
\min\|(I-M^{-1}A)v_{0}\|=\min_{q\in\mathbb{P}_{d}}\|v_{0}-Aq(A)v_{0}\|
\]

\end_inset

by building a power basis 
\begin_inset Formula $Y=\{v_{0},Av_{0},\ldots,A^{d}v_{0}\}$
\end_inset

, and solving the normal equations 
\begin_inset Formula 
\[
(AY)^{T}AYy=(AY)v_{0}.
\]

\end_inset


\end_layout

\begin_layout Standard
The elements of 
\begin_inset Formula $y$
\end_inset

 
\begin_inset Note Note
status open

\begin_layout Plain Layout
\begin_inset Formula $s$
\end_inset

?
\end_layout

\end_inset

are the coefficients of 
\begin_inset Formula $M^{-1}$
\end_inset

.
\begin_inset Note Note
status open

\begin_layout Plain Layout
that is,
\begin_inset Formula $M^{-1}=y_{d+1}A^{d}+y_{d}A^{d-1}+\cdots+y_{2}A+y_{1}.$
\end_inset


\end_layout

\end_inset

 Note the following:
\end_layout

\begin_layout Itemize
The method requires no knowledge of the spectrum of 
\begin_inset Formula $A$
\end_inset

, unlike Chebyshev or least squares polynomials 
\begin_inset CommandInset citation
LatexCommand cite
key "Liu-2015"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
The method becomes unstable as the columns of 
\begin_inset Formula $Y$
\end_inset

 lose linear independence, but its results are generally sufficient for
 low-degree (up to 
\begin_inset Formula $d=10$
\end_inset

) polynomials 
\begin_inset CommandInset citation
LatexCommand cite
key "Liu-2015"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
The coefficients of the polynomial depend on the choice of 
\begin_inset Formula $v_{0}$
\end_inset

.
 Using a randomly chosen vector may be preferable in this case 
\begin_inset CommandInset citation
LatexCommand cite
key "Loe-2019"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
The matrix 
\begin_inset Formula $AY$
\end_inset

 is a matrix of dimension 
\begin_inset Formula $n\times(d+1)$
\end_inset

, and takes 
\begin_inset Formula $d+1$
\end_inset

 matrix-vector products to compute.
 The product 
\begin_inset Formula $(AY)^{T}AY$
\end_inset

 is of dimension 
\begin_inset Formula $(d+1)\times(d+1)$
\end_inset

 and requires a matrix-matrix multiplication.
 With 
\begin_inset Formula $d\ll n$
\end_inset

, the system 
\begin_inset Formula $(AY)^{T}AYy=(AY)v_{0}$
\end_inset

 is of small dimension and can be solved with a direct method such as LU
 decomposition.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
possible confusion with ILU?
\end_layout

\end_inset


\end_layout

\begin_layout Section
Numerical experiments
\begin_inset CommandInset label
LatexCommand label
name "sec:Numerical-experiments"

\end_inset


\end_layout

\begin_layout Standard
For every problem, the right-hand side is sampled from 
\begin_inset Formula $\mathcal{N}(0,1)$
\end_inset

, the real normal distribution of mean 
\begin_inset Formula $0$
\end_inset

 and standard deviation 1.
 Orthonormalization was done using the Modified Gram-Schmidt procedure.
 Right preconditioned GMRES is used for comparing residuals 
\begin_inset Formula $\|b-Ax_{i}\|$
\end_inset

 between the initial and preconditioned systems.
 The vector 
\begin_inset Formula $v_{0}$
\end_inset

 for computing the power basis 
\begin_inset Formula $Y$
\end_inset

 is sampled from 
\begin_inset Formula $U[-1,1]$
\end_inset

, the uniform distribution on the interval 
\begin_inset Formula $[-1,1]$
\end_inset

.
 
\end_layout

\begin_layout Standard
Some of the problems considered are very difficult for GMRES to solve, and,
 considering the small dimension 
\begin_inset Formula $n$
\end_inset

, may be better suited for direct solvers.
 They nonetheless give a good indication of the difficulties involved when
 using GMRES.
\end_layout

\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "enu:problem-1"

\end_inset

The 
\series bold
Circle Eigenvalue Matrix
\series default
 of size 
\begin_inset Formula $n=2000$
\end_inset

, a block diagonal matrix with 
\begin_inset Formula $2\times2$
\end_inset

 blocks:
\begin_inset Formula 
\[
\begin{pmatrix}1+\cos(\alpha) & \sin(\alpha)\\
-\sin(\alpha) & 1+\cos(\alpha)
\end{pmatrix},
\]

\end_inset


\begin_inset Formula $\alpha\in2k\frac{\pi}{n},\ k\in\{0,2,\ldots,n-2\}$
\end_inset

.
 All eigenvalues of this matrix are on the unit circle on the complex plane
 with center 
\begin_inset Formula $(1,0)$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "Liu-2015"
literal "false"

\end_inset

.
 The condition number is estimated at 
\begin_inset Formula $6.3662\times10^{3}$
\end_inset

.
\end_layout

\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "enu:problem-2"

\end_inset

The 
\series bold
Bidiagonal Matrix
\series default
 of size 
\begin_inset Formula $n=5000$
\end_inset

 with diagonal elements 0.1, 0.2, 0.3, 
\begin_inset Formula $\ldots,$
\end_inset

 0.9, 1, 2, 3, 
\begin_inset Formula $\ldots,$
\end_inset

 4990, 4991 (
\emph on
BiDiag1
\emph default
).
 The superdiagonal elements are all set to 0.2 
\begin_inset CommandInset citation
LatexCommand cite
key "Liu-2015"
literal "false"

\end_inset

.
 The symmetric part is positive definite, and the condition number estimated
 at 
\begin_inset Formula $8.4589\times10^{4}$
\end_inset

.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
GMRES(20)
\end_layout

\end_inset

 
\end_layout

\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "enu:problem-3"

\end_inset

As problem 
\begin_inset CommandInset ref
LatexCommand ref
reference "enu:problem-2"
plural "false"
caps "false"
noprefix "false"

\end_inset

, but the diagonal elements are set to 10, 11, 12, 
\begin_inset Formula $\ldots,$
\end_inset

 5009 (
\emph on
BiDiag2
\emph default
).
 The condition number is estimated at 
\begin_inset Formula $5.0137\times10^{3}$
\end_inset

.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
This problem has a smaller eigenvalue ratio and is thus easier to solve
 by GMRES.
 
\end_layout

\end_inset


\begin_inset Note Note
status open

\begin_layout Plain Layout
GMRES(20)
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "enu:problem-4"

\end_inset


\series bold
S1RMQ4M1
\series default
 (Matrix Market), a real symmetric positive definite matrix of size 
\begin_inset Formula $n=5489$
\end_inset

.
 The matrix has high condition number, estimated at 
\begin_inset Formula $3.21\times10^{6}$
\end_inset

 by Matrix Market.
\end_layout

\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "enu:problem-5"

\end_inset


\series bold
E20R0100
\series default
 (Matrix Market), a real non-symmetric indefinite matrix of size 
\begin_inset Formula $n=4241$
\end_inset

.
 The matrix has high condition number, estimated at 
\begin_inset Formula $2.15\times10^{10}$
\end_inset

 by Matrix Market.
 This matrix serves as a counter-example for classical preconditioners such
 as ILU, where their application may result in a worse condition number.
 
\end_layout

\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "enu:problem-6"

\end_inset


\series bold
SHERMAN5
\series default
 (Matrix Market), a real non-symmetric matrix of size 
\begin_inset Formula $n=3312$
\end_inset

.
 The condition number is estimated at 
\begin_inset Formula $3.9\times10^{5}$
\end_inset

 by Matrix Market.
 This matrix serves as an example where polynomial preconditioning can worsen
 convergence.
\end_layout

\begin_layout Standard
Polynomials of degree 3, 5, 7, and 10 are used for most problems.
 Implementation was done in MATLAB
\begin_inset Foot
status open

\begin_layout Plain Layout
See 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://github.com/fvanmaele/polynomial-preconditioning
\end_layout

\end_inset


\end_layout

\end_inset

, based on 
\family typewriter
gmres.m
\family default
 from the Netlib Repository.
\end_layout

\begin_layout Subsection
Numerical properties
\end_layout

\begin_layout Standard
As explained in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Preconditioning"
plural "false"
caps "false"
noprefix "false"

\end_inset

, we expect a preconditioner to be effective if the eigenvalues of 
\begin_inset Formula $M^{-1}A$
\end_inset

 are clustered around a constant value, such as 1.
 For most test problems, after applying the polynomial preconditioner this
 was indeed the case.
 The results are summarized in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:spectra-stats"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 The spectrum of E20R0100 after applying a degree 10 polynomial is shown
 in Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:spec_e20r0100"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 
\end_layout

\begin_layout Standard
For the symmetric positive definite matrix S1RMQ4M1, preconditioning with
 degree 7 and degree 9 polynomials lead to negative eigenvalues.
 These eigenvalues were outliers, and the behavior was not observed for
 polynomials of a different degree.
 One may however expect that 
\begin_inset Formula $M^{-1}A$
\end_inset

, while symmetric, is not positive definite in general.
 This limits the use of the preconditioner with the Preconditioned CG method
 
\begin_inset CommandInset citation
LatexCommand cite
key "Saad-1985"
literal "false"

\end_inset

, which depends on a symmetric positive definite preconditioner.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement b
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Extreme values, mean 
\begin_inset Formula $\mu$
\end_inset

, and standard deviation 
\begin_inset Formula $\sigma$
\end_inset

 for 
\begin_inset Formula $|\lambda(A)|$
\end_inset

, the (magnitude of the) spectrum of 
\begin_inset Formula $A$
\end_inset

.
\begin_inset CommandInset label
LatexCommand label
name "tab:spectra-stats"

\end_inset


\end_layout

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="11" columns="6">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Matrix 
\begin_inset Formula $A$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $\deg$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $\min(|\lambda(A)|)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $\max(|\lambda(A)|$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $\mu(|\lambda(A)|$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $\sigma(|\lambda(A)|)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="3" alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size scriptsize
CEM
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
–
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.00314
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
2
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
1.2742
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.61523
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
3
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.0063
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
1.1371
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.8663
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.2241
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="3" alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size scriptsize
BiDiag1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
–
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.1
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
4991
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
2491.5
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
1443.5
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
3
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.00024
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
1.1509
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.95895
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.19989
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="3" alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size scriptsize
BiDiag2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $-$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
5009
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
2509.5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
1443.5
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $3$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.0239
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
1.1535
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.9626
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.1919
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="3" alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size scriptsize
S1RMQ4M1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
–
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.3797
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
6.8743e+05
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
8.676e+04
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
1.2595e+05
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
5
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
1.476e-05 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
1.21
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.4977
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.4995
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="3" alignment="center" valignment="middle" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size scriptsize
E20R0100
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
–
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
1.3999e-06
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
13.057
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
4.3537
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
4.074
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
10
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
4.8582e-06
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
1.0902
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.71268
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.44947
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement t
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename example_5_spec.png
	width 45text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Spectrum of 
\begin_inset Formula $A$
\end_inset

 (blue) and 
\begin_inset Formula $M^{-1}A$
\end_inset

 (orange, 
\begin_inset Formula $d=10$
\end_inset

) for E20R0100
\begin_inset CommandInset label
LatexCommand label
name "fig:spec_e20r0100"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
For most test problems, the condition number was inversely proportional
 to the degree of the applied polynomial.
 In those cases, a degree 
\begin_inset Formula $10$
\end_inset

 polynomials decreased the condition number by a degree of magnitude.
 The exception was SHERMAN5, where the condition number varied strongly
 for different degree polyomials.
 This is illustrated in Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:cond_circle_evm"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 We will consider this special case in the following section.
\end_layout

\begin_layout Subsection
Convergence
\end_layout

\begin_layout Standard
We now consider convergence of the studied test problems.
 A faster convergence rate in the preconditioned system leads, for a certain
 tolerance, to a lower amount of steps in the (restarted) GMRES method.
 This leads in turn to a smaller number of inner products (see Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Inner-products"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 We also study the impact of polynomial preconditioning on the amount of
 sparse matrix-vector products.
\end_layout

\begin_layout Standard
In the below, the maximum of iterations is set to 20,000, and the tolerance
 to 
\begin_inset Formula $\varepsilon=10^{-8}$
\end_inset

 for the relative residual 
\begin_inset Formula $\frac{\|b-Ax_{m}\|}{\|b\|}$
\end_inset

.
\end_layout

\begin_layout Itemize

\series bold
BiDiag1
\series default
 and 
\series bold
BiDiag2
\series default
 converged without preconditioning using GMRES(20), reaching 
\begin_inset Formula $\varepsilon=10^{-8}$
\end_inset

 in 18,193 and 258 steps, respectively.
 Preconditioning increased the convergence rate, reaching the tolerance
 in 1,786 and 60 steps, respectively, with a degree 3 polynomial.
\end_layout

\begin_layout Itemize

\series bold
S1RMQ4M1
\series default
 did not converge with GMRES(50) below 20,000 steps, and a polynomial of
 degree 5 was required to converge (in 11,901 steps).
 Higher degree polynomials lead to better results.
 See Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:convergence_s1rmq4m1"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Itemize
The 
\series bold
Circle Eigenvalue Matrix
\series default
 did not converge even with GMRES(100), but a degree 3 polynomial sufficed
 for convergence in 12,564 steps.
\end_layout

\begin_layout Itemize

\series bold
E20R0100
\series default
 is a more difficult problem, and required a degree 7 polynomial to converge
 (in 9,500 steps) with GMRES(100).
 The problem converged in only 997 steps if we raised the polynomial degree
 to 10.
 See Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:convergence_e20r0100"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Itemize
Results for 
\series bold
SHERMAN5
\series default
 varied between samples of 
\begin_inset Formula $v_{0}$
\end_inset

 of 
\begin_inset Formula $b$
\end_inset

.
 Loe 
\begin_inset CommandInset citation
LatexCommand cite
key "Loe-2019"
literal "false"

\end_inset

 suggested degree 7 polynomials for improved convergence.
 For the tested samples (seed 
\begin_inset Formula $\in\{42,666,1892\}$
\end_inset

), we had more consistent results with a degree 3 polynomial.
 In this case, eigenvalues of 
\begin_inset Formula $M^{-1}A$
\end_inset

 were mapped to the right half of the complex plane.
 Other degrees typically resulted in worse convergence.
 GMRES without preconditioning, however, converged reliably for each sample.
 See Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:convergence_SHERMAN5-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:convergence_SHERMAN5-2"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement b
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Inner products for polynomials of different degree
\begin_inset CommandInset label
LatexCommand label
name "tab:Inner-products"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="6">
<features booktabs="true" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
Inner p.
 
\backslash
 deg
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size scriptsize
deg = 0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size scriptsize
deg = 3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size scriptsize
deg = 5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size scriptsize
deg = 7
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size scriptsize
deg = 10
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
CEM
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
1,010,000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
633,330
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
304,176
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
183,285
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
92,385
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
BiDiag1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
190,981
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
18,711
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
9,261
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
5,526
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
2,541
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
BiDiag2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
2,691
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
630
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
423
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
288
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
153
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
S1RMQ4M1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
510,000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
510,000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
303,451
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
171,553
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
84,051
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
E20R0100
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
1,010,000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
1,010,000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
1,010,000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
479,750
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
50,203
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset

The amount of SpMVs increased by ~3x (for S1RMQ4M1) up to ~6x (for the Circle
 Eigenvalue Matrix) for preconditioned matrices.
 For E20R0100, there was up to ~8x increase, but with fast convergence of
 the degree 10 preconditioner, latter only resulted in an increase of ~1.25x
 in SpMVs.
 See Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:SpMVs"
plural "false"
caps "false"
noprefix "false"

\end_inset

 for an overview.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement b
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
SpMVs for polynomials of different degree
\begin_inset CommandInset label
LatexCommand label
name "tab:SpMVs"

\end_inset


\end_layout

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="6">
<features booktabs="true" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
SpMVs 
\backslash
 deg
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size scriptsize
deg = 0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size scriptsize
deg = 3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size scriptsize
deg = 5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size scriptsize
deg = 7
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size scriptsize
deg = 10
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
CEM
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
20,401
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
50,886
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
36,715
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
29,565
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
20,622
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
BiDiag1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
20,013
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
7,594
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
5,631
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
4,491
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
2,862
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
BiDiag2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
284
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
255
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
273
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
274
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
209
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
S1RMQ4M1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
20,801
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
82,001
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
73,079
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
55,111
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
37,070
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
E20R0100
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
20,401
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
81,001
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
121,401
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
76,855
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
11,087
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Remark
The polynomial preconditioner had very small coefficients for its higher-order
 terms, for all problems except the Circle Eigenvalue Matrix (Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:polynomial-coefficients"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 This effect may originate from the ill-conditioned nature of computing
 coefficients with the normal equations and a power basis 
\begin_inset CommandInset citation
LatexCommand cite
after "III"
key "Loe-2019"
literal "false"

\end_inset

.
 In particular, LAPACK reported a very small 
\emph on
RCOND
\emph default
 for these problems (below 
\begin_inset Formula $10^{-17}$
\end_inset

 for E20R011 and below 
\begin_inset Formula $10^{-25}$
\end_inset

 for S1RMQ4M1).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename example_6_condition.png
	width 45text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Condition numbers for E20R0100 (blue) and SHERMAN5 (orange), depending on
 the polynomial degree of the preconditioner.
\begin_inset CommandInset label
LatexCommand label
name "fig:cond_circle_evm"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename example_4_gmres.png
	width 40text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Convergence of S1RMQ4M1, GMRES(50) 
\begin_inset CommandInset label
LatexCommand label
name "fig:convergence_s1rmq4m1"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename example_5_gmres.png
	width 40text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Convergence of E20R0100, GMRES(100) 
\begin_inset CommandInset label
LatexCommand label
name "fig:convergence_e20r0100"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement t
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename example_6_gmres_seed_42.png
	width 40text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Convergence of SHERMAN5, GMRES(100), seed = 42 
\begin_inset CommandInset label
LatexCommand label
name "fig:convergence_SHERMAN5-1"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename example_6_gmres_seed_1892.png
	width 39text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Convergence of SHERMAN5, GMRES(100), seed = 1892 
\begin_inset CommandInset label
LatexCommand label
name "fig:convergence_SHERMAN5-2"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section*
Conclusion
\end_layout

\begin_layout Standard
Polynomial preconditioners can be used along with standard preconditioning,
 and are effective to implement on parallel systems as a series of sparse
 matrix-vector products.
 We have introduced a polynomial preconditioner related to the minimum residual
 (GMRES) polynomial.
 
\end_layout

\begin_layout Standard
To compute the coefficient of the polynomial, no knowledge of the spectrum
 of 
\begin_inset Formula $A$
\end_inset

 is required.
 It suffices to take a random vector 
\begin_inset Formula $v_{0}$
\end_inset

, and solve the least squares problem 
\begin_inset Formula $\min\|v_{0}-s(A)Av_{0}\|$
\end_inset

.
 This however bases on computing a power basis 
\begin_inset Formula $(A^{i}v_{0})$
\end_inset

, which is ill-conditioned.
 Therefore the degree of the polynomial is limited, typically to 
\begin_inset Formula $d\leq10$
\end_inset

.
\end_layout

\begin_layout Standard
Applying this preconditioner to several difficult problems, including E20R0100,
 shows it can be used to significantly improve convergence of GMRES.
 In particular, on parallel systems, synchronization points from inner products
 in each GMRES step are reduced.
 
\end_layout

\begin_layout Standard
Care should be taken for problems such as SHERMAN5, where effectiveness
 varies for different samples of the vector 
\begin_inset Formula $v_{0}$
\end_inset

, and can even result in worse convergence.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Coefficients for polynomial preconditioners of degree 
\begin_inset Formula $7$
\end_inset

, 
\begin_inset Formula $M^{-1}=s^{8}A^{7}+\cdots+s^{2}A+s^{1}I$
\end_inset


\begin_inset CommandInset label
LatexCommand label
name "tab:polynomial-coefficients"

\end_inset


\end_layout

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="9" columns="6">
<features booktabs="true" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $A$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size scriptsize
CEM
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size scriptsize
BiDiag1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size scriptsize
BiDiag2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size scriptsize
S1RMQ4M1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\size scriptsize
E20R0100
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $s^{8}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-0.1107
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-7.123e-27
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-6.909e-27
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-1.219e-43
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-1.456e-06
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $s^{7}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.9963
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
1.505e-22
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
1.464e-22
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
3.352e-37
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
8.264e-05
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $s^{6}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-3.987
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-1.314e-18
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-1.282e-18
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-3.779e-31
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-0.001952
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $s^{5}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
9.309
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
6.119e-15
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
5.982e-15
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
2.249e-25
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.02483
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $s^{4}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-13.97
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-1.635e-11
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-1.602e-11
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-7.598e-20
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-0.1838
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $s^{3}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
13.98
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
2.507e-08
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
2.463e-08
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
1.455e-14
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.7974
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $s^{2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-9.327
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-2.082e-05
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-2.05e-05
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-1.487e-09
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
-1.935
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
\begin_inset Formula $s^{1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.00807
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
0.007982
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
6.967e-05
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size scriptsize
2.324
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "Saad-1986"
literal "false"

\end_inset

Y.
 SAAD, M.
 H.
 Schultz, 
\emph on
GMRES: A generalized minimal residual algorithm for solving nonsymmetric
 linear systems,
\emph default
 SIAM J.
 Sci.
 Stat.
 Comput.
 Vol.
 7, No.
 3, July 1986.
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "Saad-1985"
literal "false"

\end_inset

Y.
 SAAD, 
\emph on
Practical use of polynomial preconditionings for the conjugate gradient
 method
\emph default
, SIAM J.
 Sci.
 Stat.
 Comput.
 Vol.
 6, No.
 4, October 1985.
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "Magoules-2015"
literal "false"

\end_inset

F.
 MAGOULES, F.
 ROUX, G.
 HOUZEAUX, 
\emph on
Parallel Scientific Computing, 
\emph default
Wiley, 2015.
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "Saad-2003"
literal "false"

\end_inset

Y.
 SAAD, 
\emph on
Iterative Methods for Sparse Linear Systems
\emph default
, SIAM, 2003.
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "Trefethen-1997"
literal "false"

\end_inset

L.
 N.
 TREFETHEN, D.
 BAU, 
\emph on
Numerical Linear Algebra
\emph default
, SIAM, 1997.
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "Benzi-2005"
literal "false"

\end_inset

M.
 BENZI, G.
 H.
 GOLUB, J.
 LIESEN, 
\emph on
Numerical solution of saddle point problems, 
\emph default
Acta Numerica (2005), pp.
 1-137.
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "Rozložník-2018"
literal "false"

\end_inset

M.
 ROZLOŽNÍK, 
\emph on
Saddle-Point Problems and Their Iterative Solution
\emph default
, Birkhäuser, 2018.
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "Barret-1994"
literal "false"

\end_inset

R.
 BARRET et.
 al., 
\emph on
Templates for the Solution of Linear Sytems: Building Blocks for Iterative
 Methods
\emph default
, SIAM, 1994.
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "Liu-2015"
literal "false"

\end_inset

Q.
 LIU, R.
 B.
 MORGAN, W.
 WILCOX, 
\emph on
Polynomial Preconditioned GMRES and GMRES-DR
\emph default
, SIAM J.
 Sci.
 Comput.
 Vol.
 37, No.
 5, pp.
 S407-S428, 2015.
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "Loe-2019"
literal "false"

\end_inset

J.
 A.
 LOE, H.
 K.
 THORNQUIST, E.
 G.
 BOMAN, 
\emph on
Polynomial Preconditioned GMRES to Reduce Communication in Parallel Computing
\emph default
, arXiv, Oct 2019.
\end_layout

\begin_layout Bibliography
\begin_inset CommandInset bibitem
LatexCommand bibitem
key "Hernandez-2005"
literal "false"

\end_inset

V.
 HERNANDÉZ, J.
 E.
 ROMÁN, A.
 TOMAS, 
\emph on
A Parallel Variant of the Gram-Schmidt Process with Reorthogonalization
\emph default
, Proceedings of the International Conference Parco 2005, 13-16 September
 2005.
\end_layout

\end_body
\end_document
